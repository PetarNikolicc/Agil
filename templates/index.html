{% extends "base.html" %}

{% block content %}
<div style="text-align:center;">
    <h1>Välj tillagningstid</h1>
    <form method="get" action="/">
        <button type="submit" name="time" value="15">15 minuter</button>
        <button type="submit" name="time" value="30">30 minuter</button>
        <button type="submit" name="time" value="60">60 minuter</button>
    </form>
    <h2>Recept</h2>
    <ul id="recipes-list">
        {% for recipe in recipes %}
            <li><a href="#" onclick="openRecipePopup({{ recipe[0] }})">{{ recipe[1] }} - {{ recipe[2] }} minuter</a></li>
        {% endfor %}
    </ul>
</div>

<div id="recipe-popup" class="popup" style="display:none;">
    <div class="popup-content">
        <span class="close" id="close-popup">&times;</span>
        <h2 id="recipe-title"></h2>
        <img id="recipe-image" src="" alt="Recipe Image" style="width:100%;">
        <p id="recipe-description"></p>
        <h3>Instruktioner</h3>
        <p id="recipe-instructions"></p>
    </div>
</div>

<script>
function openRecipePopup(recipeId) {
    fetch(`/recipe/${recipeId}`)
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error);
                return;
            }
            document.getElementById('recipe-title').textContent = data.name;
            document.getElementById('recipe-description').textContent = data.description;
            document.getElementById('recipe-instructions').textContent = data.instructions;
            document.getElementById('recipe-image').src = data.image || '/static/no-image.png';
            document.getElementById('recipe-popup').style.display = 'block';
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to fetch recipe details');
        });
}

document.getElementById('close-popup').addEventListener('click', function() {
    document.getElementById('recipe-popup').style.display = 'none';
});

</script>

<style>
.popup {
    position: fixed;
    z-index: 10;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
}

.popup-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 40px; /* Ökad padding för mer whitespace */
    border: 1px solid #888;
    width: 50%;
}

.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.close:hover, .close:focus {
    color: black;
    text-decoration: none;
}
</style>

{% endblock %}
